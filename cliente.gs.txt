function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);

    const ss = SpreadsheetApp.getActiveSpreadsheet();
    //const sheet = ss.getSheetByName('usuarios');
    const sheet = ss.getSheetByName('Clientes');
    // Obtém índices das colunas
    const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
    const colIndex = {};
    headers.forEach((titulo, i) => (colIndex[titulo] = i + 1));

   

    // --- Insere novo registro ---
    const nextRow = sheet.getLastRow() + 1;
    
    const novoRegistro = {
      'CPF': data.cpf,
      'Telefone': data.tel,
      'CEP': data.cep,
      'Logradouro': data.logradouro,
      'Cidade': data.cidade,
      'Estado': data.estado,
      'Bairro': data.bairro,
    };

    // Preenche as células
    Object.keys(novoRegistro).forEach(campo => {
      const col = colIndex[campo];
      if (col) {
        sheet.getRange(nextRow, col)
             .setValue(novoRegistro[campo])
             .setBorder(true, true, true, true, true, true, '#000000', SpreadsheetApp.BorderStyle.SOLID_MEDIUM);
      }
    });

    return ContentService
      .createTextOutput(JSON.stringify({ 
        status: 'sucesso', 
        message: 'Usuário cadastrado com sucesso!' 
      }))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({ 
        status: 'erro', 
        message: `Falha no cadastro: ${error.message}`
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
