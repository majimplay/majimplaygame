function doPost(e) {
  try {
    // Parse the JSON data sent from the client-side JavaScript
    var data = JSON.parse(e.postData.contents);

    // Get the active spreadsheet and the specific sheet (assuming it's the first sheet)
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = ss.getSheets()[0]; // Or use ss.getSheetByName("YourSheetName");
    
    
     // var sheet = ss.getSheetByName('planilha login com gogo');//erro
     // var sheet = ss.getSheetByName('usuarios');//erro
    // Append a new row with the received data and a timestamp
    // Make sure the order matches your sheet columns
    sheet.appendRow([
    data.name,       // Nome (coluna A)
    data.email,      // E-mail (coluna B)
    data.picture,    // FotoURL (coluna C)
    new Date(),      // Timestamp (coluna D)
    data.id          // GoogleID (coluna E)
    ]);
        // Formatação da nova linha (A a E)
    const newRow = sheet.getLastRow();
    sheet.getRange(newRow, 1, 1, 5) // Intervalo A:E
         .setBorder(true, true, true, true, true, true, '#000000', SpreadsheetApp.BorderStyle.SOLID_MEDIUM);

    // Return a success response
    return ContentService
      .createTextOutput(JSON.stringify({ status: 'success', message: 'Data saved to sheet.' }))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    // Log the error for debugging
    Logger.log(error);

    // Return an error response
    return ContentService
      .createTextOutput(JSON.stringify({ status: 'error', message: error.toString() }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
